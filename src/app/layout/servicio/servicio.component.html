<div class="row justify-content-center">
    <mat-progress-bar *ngIf="cargando && !modalIn" mode="indeterminate" class="alert-loading"></mat-progress-bar>
    <ngb-alert *ngIf="mostrar_alerta && !modalIn" [type]="tipo_alerta" (closed)="mostrar_alerta = false" class="alert-loading">{{mensaje_alerta}}</ngb-alert>
    
    <!-- Page Heading -->
    <h1 class="h3 mb-2 text-gray-800 col-12 text-center">Solicitar Servicios</h1>

    <!-- DataTales Example -->
    <div class="card shadow mb-3 col-12 col-lg-8" style="height: 100%;">
        <div class="card-header py-3 row">
            <div class="col-12 col-lg-2">
                <button (click)="nuevoCliente()" style="width:100%" type="button" class="boton btn btn-primary ">Nuevo Cliente</button>
            </div>
            <div class="col-12 col-lg-2">
                <button (click)="crearMascota()" style="width:100%" type="button" class="boton btn btn-primary ">Nueva Mascota</button>
            </div>
        </div>
        <div class="card-body text-gray-400 ">
            <form [formGroup]="servicioForm">
                <div class="row justify-content-between color-row-table">
                    <div class="col-12 col-md-5 col-lg-5 mb-4">
                        <div class="row">
                            <section>   
                                <label for="inputTiposServicio" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Tipo de servicio: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <select formControlName="servicio"  id="inputTiposServicio" class="border-left-primary form-select" >
                                    <option hidden value="" disabled>Escoge una opción</option>
                                    <option [value]="tipos.TIPO_SERVICIO_ID" *ngFor="let tipos of tiposServicios">{{tipos.TIPO_SERVICIO_NOMBRE}}</option>
                                </select>   
                                <div *ngIf="servicio.invalid && (servicio.dirty || servicio.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="servicio.errors.required">
                                        * El tipo de servicio es requerido.
                                    </div>
                                </div>
                            </section>
                            
                        </div>
                        <br>
                        <div class="row">
                            <section>
                                <label for="inputFormaDePago" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Forma de pago: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <select  formControlName="forma_pago" id="inputFormaDePago" class="border-left-primary form-select">
                                    <option hidden value="" disabled>Selecciona una opción</option>
                                    <option [value]="metodo.MDP_ID" *ngFor="let metodo of metodos_pago">{{metodo.MDP_NOMBRE}}</option>
                                </select>
                                <div *ngIf="forma_pago.invalid && (forma_pago.dirty || forma_pago.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="forma_pago.errors.required">
                                        * La forma de pago es requerida.
                                    </div>
                                </div>
                            </section>
                        </div>
                        <br>
                        <div class="row">
                            <section>
                                <label for="inputPrecioServicio" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Precio (S/): <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input type="text" name="inputPrecioServicio" formControlName="precio" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="precio.invalid && (precio.dirty || precio.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="precio.errors.required">
                                        * El precio es requerido.
                                    </div>
                                    <div *ngIf="precio.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                </div>
                            </section>
                        </div>
                        <br>
                        <div class="row">
                            <section>
                                <label for="inputFechaCitaServicio" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Fecha de atención: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input [min]="getTodayFecha()" [ngClass]="{'textoGris': opacarFecha }" (change)="cambiarDeStyleDate()" type="date" name="inputFechaCitaServicio" formControlName="fecha" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="fecha.invalid && (fecha.dirty || fecha.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="fecha.errors.required">
                                        * La fecha de atención es requerida.
                                    </div>
                                </div>
                            </section>
                        </div>
                        
                    </div>
                    <div class="col-12 col-md-5 col-lg-5">
                        <div class="row">
                            <section>   
                                <label for="inputModalidadServicio" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Modalidad: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <select  formControlName="modalidad" id="inputModalidadServicio" class="border-left-primary form-select">
                                    <option hidden value="" disabled>Selecciona una opción</option>
                                    <option [value]="0" >INSTANTÁNEA</option>
                                    <option [value]="1" >CITA</option>
                                </select>
                                <div *ngIf="modalidad.invalid && (modalidad.dirty || modalidad.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="modalidad.errors.required">
                                        * El tipo de modalidad es requerido.
                                    </div>
                                </div>
                            </section>
                        </div>
                        <br>
                        <div class="row">
                            <section>
                                <label for="inputTipoComprobante" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Tipo comprobante: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <select  formControlName="tipo_comprobante" id="inputTipoComprobante" class="border-left-primary form-select"  (change)="obtenerTipoDocumento()">
                                    <option hidden value="" disabled>Selecciona una opción</option>
                                    <option [value]="comprobante.COMPROBANTE_ID" *ngFor="let comprobante of comprobantes">{{comprobante.COMPROBANTE_TIPO}}</option>
                                </select>
                                <div *ngIf="tipo_comprobante.invalid && (tipo_comprobante.dirty || tipo_comprobante.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="tipo_comprobante.errors.required">
                                        * El tipo de comprobante es requerido.
                                    </div>
                                </div>
                            </section>
                        </div>
                        <br>
                        <div class="row">
                            <section class="col-10 col-sm-10 col-md-9 col-lg-9">
                                <label for="inputMascotaServicio" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Mascota: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input disabled value="{{nombre_mascota_seleccionada}}" type="text" id="inputMascotaServicio" class="border-left-primary font-tamanio form-control">
                            </section>
                            <section class="col-2 col-sm-1 col-md-1 col-lg-1 py-1" style="margin-top: 1.7rem !important;">
                                <button [disabled]="!buscarMascota" (click)="abrirBusqueda()" type="button" class="btn btn-primary btn-icon-split" ><i class="fas fa-search"></i></button>
                            </section>
                        </div>
                        <br>
                        <div class="row">
                            <section>
                                <label for="inputHoraServicio" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Hora del servicio: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <ngb-timepicker  formControlName="hora"   class="notranslate" [seconds]="seconds" [meridian]="meridian" id="inputHoraServicio"></ngb-timepicker>
                            </section>
                        </div>
                    </div>
                </div>
                <div class="row justify-content-between color-row-table mt-4">
                    <div class="col-sm-12 col-md-9">
                        <label for="inputDescripcionServicio">Descripción:</label>
                        <textarea formControlName="descripcion"  type="text" id="inputDescripcionServicio" class="border-left-primary font-tamanio form-control"></textarea>
                        <div *ngIf="descripcion.invalid && (descripcion.dirty || descripcion.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                            <div *ngIf="descripcion.errors.maxlength">
                                * Se requieren máximo 200 caracteres.
                            </div>
                            <div *ngIf="descripcion.errors.pattern">
                                * El formato es inválido.
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-3 ">
                        <label for="inputAdelantoServicio">Adelanto (S/):</label>
                        <input formControlName="adelanto"  type="text" id="inputAdelantoServicio" class="border-left-primary font-tamanio form-control" (keyup)="adelantarDinero(adelanto.value)">
                        <div *ngIf="adelanto.invalid && (adelanto.dirty || adelanto.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                            <div *ngIf="adelanto.errors.pattern">
                                * El formato es inválido.
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="card-footer py-3 row justify-content-center">
            <div class="col-sm-12 col-md-4 col-xl-3 ">
                <button [disabled]="servicioForm.invalid || cargando || !mascota_seleccionada || !buscarMascota || adelantoError" (click)="confirmarServicio()" type="button" class="btn btn-primary">Crear Servicio</button>
            </div>
        </div>
    </div>
</div>


<ng-template #buscarMascotaModal>
    <div class="modal-header justify-content-center">
        <h4 class="modal-title " >Buscar Mascota</h4>
    </div>
    <mat-progress-bar *ngIf="cargando && modalIn" mode="indeterminate" ></mat-progress-bar>
    <ngb-alert *ngIf="mostrar_alerta && modalIn" [type]="tipo_alerta" (closed)="mostrar_alerta = false" >{{mensaje_alerta}}</ngb-alert>
    <div class="modal-body">
        <div class="row">
            <div class="card shadow mb-3 " style="height: 100%;">
                <div class="card-header py-3 row justify-content-between">
                    <div class="py-1 col-sm-12 col-md-5 col-lg-4">
                        <div class="row">
                            <div class="col-10">
                                <input type="text" class="border-left-primary font-tamanio form-control"  [(ngModel)]="busquedaMascota" name="busquedaMascota" placeholder="Nombre de la mascota..." (keyup.enter)="filtrarMascotaPorNombre()">
                            </div>
                            <div class="col-1">
                                <button (click)="filtrarMascotaPorNombre()" class="btn btn-success"><i class="fa fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="py-1 col-sm-12 col-md-5 col-lg-4">
                        <div class="row ">
                            <div class="col-10">
                                <input id="inputBuscarCategoria" type="text" [(ngModel)]="busquedaCliente" class="border-left-primary font-tamanio form-control" name="busquedaCliente" placeholder="Nombre del dueño..." (keyup.enter)="filtrarMascotaPorCliente()">
                            </div>
                            <div class="col-1">
                                <button (click)="filtrarMascotaPorCliente()" class="btn btn-success"><i class="fa fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body text-gray-400 ">
                    <div  *ngIf="mascotas.length<=0; else mascotaModule">
                        <h3>No hay mascotas registradas.</h3>
                    </div>
                    <!---------------PAGINACIÓN------------->
                    <div *ngIf="mascotas?.length>0" class="row box-footer clearfix mt-3">     
                        <div class="col-xl-10 col-lg-9 col-md-7 col-sm-7 col-6">
                            <ngb-pagination *ngIf="mascotas?.length>5" class="d-flex justify-content-start" size="sm" [maxSize]="5" [pageSize]="itemsPerPage"  [collectionSize]="mascotas?.length" [(page)]="currentPage"></ngb-pagination>
                        </div>
                        <div class="col-xl-2 col-lg-3 col-md-5 col-sm-5 col-6">
                            <select class="pull-right" [(ngModel)]="itemsPerPage" class="form-control form-control-sm custom-select">
                                <option value="50">50 elementos</option>                    
                                <option value="100">100 elementos</option>                    
                                <option value="200">200 elementos</option>                    
                            </select>  
                        </div>    
                    </div>
                    <ng-template #mascotaModule>
                        <h5>*Los botones deshabilitados son por el tipo de comprobante</h5>
                        <div class="table-module">
                            <table class="table table-bordered text-gray-400" id="dataTable" cellspacing="1">
                                <thead>
                                    <tr>
                                        <th class="color-row-table puntero">Agregar</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="MAS_ID" (sort)="onSort($event)">Código</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="TIPO_CLIENTE" (sort)="onSort($event)">Tipo Cliente</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="MAS_ESPECIE" (sort)="onSort($event)">Especie</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="MAS_NOMBRE" (sort)="onSort($event)">Nombres</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="MAS_RAZA" (sort)="onSort($event)">Raza</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="MAS_COLOR" (sort)="onSort($event)">Color</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="MAS_ATENCIONES" (sort)="onSort($event)">Atenciones</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="CLIENTE_NOMBRES" (sort)="onSort($event)">Dueño</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="CLIENTE_TELEFONO" (sort)="onSort($event)">Télefono</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let mascota of mascotas | slice:(currentPage-1)*itemsPerPage:currentPage*itemsPerPage ; let i = index ">
                                        <td class="color-row-table text-center">
                                            <button [disabled]="mascota.TIPO_CLIENTE!=tipo_cliente" (click)="agregarMascota(mascota)" class="btn btn-success btn-circle btn-sm" ngbTooltip="Agregar" >
                                                <i class="fa fa-check" aria-hidden="true"></i>
                                            </button>
                                        </td>
                                        <td [ngStyle]="{'background':mascota.MAS_ID==mascota_id_seleccionada?'#0d6efd':'white','color':mascota.MAS_ID==mascota_id_seleccionada?'white':'#6E707E'}" class="color-row-table">{{mascota.MAS_ID}}</td>
                                        <td [ngStyle]="{'background':mascota.MAS_ID==mascota_id_seleccionada?'#0d6efd':'white','color':mascota.MAS_ID==mascota_id_seleccionada?'white':'#6E707E'}" class="color-row-table">{{mascota.TIPO_CLIENTE==0?'NATURAL':(mascota.TIPO_CLIENTE==1)?'JURÍDICO':'ERROR'}}</td>
                                        <td [ngStyle]="{'background':mascota.MAS_ID==mascota_id_seleccionada?'#0d6efd':'white','color':mascota.MAS_ID==mascota_id_seleccionada?'white':'#6E707E'}" class="color-row-table">{{mascota.MAS_ESPECIE}}</td>
                                        <td [ngStyle]="{'background':mascota.MAS_ID==mascota_id_seleccionada?'#0d6efd':'white','color':mascota.MAS_ID==mascota_id_seleccionada?'white':'#6E707E'}" class="color-row-table">{{mascota.MAS_NOMBRE}}</td>
                                        <td [ngStyle]="{'background':mascota.MAS_ID==mascota_id_seleccionada?'#0d6efd':'white','color':mascota.MAS_ID==mascota_id_seleccionada?'white':'#6E707E'}" class="color-row-table">{{mascota.MAS_RAZA}}</td>
                                        <td [ngStyle]="{'background':mascota.MAS_ID==mascota_id_seleccionada?'#0d6efd':'white','color':mascota.MAS_ID==mascota_id_seleccionada?'white':'#6E707E'}" class="color-row-table">{{mascota.MAS_COLOR}}</td>
                                        <td [ngStyle]="{'background':mascota.MAS_ID==mascota_id_seleccionada?'#0d6efd':'white','color':mascota.MAS_ID==mascota_id_seleccionada?'white':'#6E707E'}" class="color-row-table">{{mascota.MAS_ATENCIONES}}</td>
                                        <td [ngStyle]="{'background':mascota.MAS_ID==mascota_id_seleccionada?'#0d6efd':'white','color':mascota.MAS_ID==mascota_id_seleccionada?'white':'#6E707E'}" class="color-row-table">{{mascota.CLIENTE_NOMBRES}}</td>
                                        <td [ngStyle]="{'background':mascota.MAS_ID==mascota_id_seleccionada?'#0d6efd':'white','color':mascota.MAS_ID==mascota_id_seleccionada?'white':'#6E707E'}" class="color-row-table">{{mascota.CLIENTE_TELEFONO}}</td>
                                    </tr>
                                </tbody>
                                
                            </table>
                            
                        </div>
                    </ng-template>
                </div>
            </div>
        </div>
        
        <div class="row d-flex text-center justify-content-center">
            <div class="my-2 col-sm-12 col-md-12 col-lg-3">
                <button (click)="closeModal();" class="btn btn-warning btn-icon-split">
                    <span class="text">Volver&nbsp;<i class="fas fa-arrow-circle-left"></i></span>
                </button>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #confirmarServicioModal>
    <div class="modal-header justify-content-center">
        <h4 class="modal-title " >Resumen del servicio</h4>
    </div>
    <mat-progress-bar *ngIf="cargando && modalIn" mode="indeterminate" ></mat-progress-bar>
    <ngb-alert *ngIf="mostrar_alerta && modalIn" [type]="tipo_alerta" (closed)="mostrar_alerta = false" >{{mensaje_alerta}}</ngb-alert>
    <div class="modal-body">
        <div class="row">
            <div class="card shadow mb-3 " style="height: 100%;">
                <div class="card-header py-3 row ">
                    <h5>Servicio</h5>
                </div>
                <div class="card-body shadow h-100 mb-3">
                    <div class="py-3 row text-center" [ngStyle]="{'background':servicioInsertar.SERVICIO_TIPO==1?'#0d6efd':'#198754','color':servicioInsertar.SERVICIO_TIPO==0?'white':'white'}">
                        <h5>(S/ {{servicioInsertar.SERVICIO_PRECIO}})</h5>
                    </div>
                    <div class="card-body text-gray-400">
                        <div class="row color-row-table">
                            <div class="col-5">
                                <i class="fa fa-calendar" style="width: 1.5rem;"></i><strong>Fecha:</strong> 
                            </div>
                            <div class="col-7">
                                {{servicioInsertar.SERVICIO_FECHA_HORA | date: 'dd/MM/yyyy'}}
                            </div>
                        </div>
                        <div class="row color-row-table">
                            <div class="col-5 ">
                                <i class="fa fa-clock" style="width: 1.5rem;"></i><strong>Hora:</strong> 
                            </div>
                            <div class="col-7">
                                {{servicioInsertar.HORA_SERVICIO}}
                            </div>
                        </div>
                        <div class="row color-row-table">
                            <div class="col-5 ">
                                <i class="fas fa-paw" style="width: 1.5rem;"></i><strong>Especie:</strong> 
                            </div>
                            <div class="col-7">
                                {{mascota_seleccionada?.MAS_ESPECIE}}
                            </div>
                        </div>
                        <div class="row color-row-table">
                            <div class="col-5 ">
                                <i class="fas fa-edit" style="width: 1.5rem;"></i><strong>Nombre:</strong> 
                            </div>
                            <div class="col-7">
                                {{mascota_seleccionada?.MAS_NOMBRE}}
                            </div>
                        </div>
                        <div class="row color-row-table">
                            <div class="col-5 ">
                                <i class="fas fa-palette" style="width: 1.5rem;"></i><strong>Color:</strong> 
                            </div>
                            <div class="col-7">
                                {{mascota_seleccionada?.MAS_COLOR}}
                            </div>
                        </div>
                        <div class="row color-row-table">
                            <div class="col-5 ">
                                <i class="fas fa-user" style="width: 1.5rem;"></i><strong>Dueño:</strong> 
                            </div>
                            <div class="col-7">
                                {{mascota_seleccionada?.CLIENTE_NOMBRES}} {{mascota_seleccionada?.CLIENTE_APELLIDOS}}
                            </div>
                        </div>
                        <div *ngIf="+adelanto.value > 0" class="row color-row-table">
                            <div class="col-5 ">
                                <i class="fas fa-money-bill-alt" style="width: 1.5rem;"></i><strong>Pago adelantado:</strong> 
                            </div>
                            <div class="col-7">
                                {{servicioInsertar.SERVICIO_ADELANTO}}
                            </div>
                        </div>
                        <div class="row color-row-table">
                            <div class="col-5 ">
                                <i class="fas fa-money-bill" style="width: 1.5rem;"></i><strong>Pago pendiente:</strong> 
                            </div>
                            <div class="col-7">
                                {{(servicioInsertar.SERVICIO_PRECIO-servicioInsertar.SERVICIO_ADELANTO).toFixed(2)}}
                            </div>
                        </div>
                        <div *ngIf="descripcion.value" class="row color-row-table">
                            <div class="col-5 ">
                                <i class="fas fa-comment-dots" style="width: 1.5rem;"></i><strong>Descripción:</strong> 
                            </div>
                            <div class="col-7">
                                {{servicioInsertar.SERVICIO_DESCRIPCION}}
                            </div>
                        </div>
                    </div>
                    
                </div>
                
            </div>
        </div>
        
        <div class="row d-flex text-center justify-content-between">
            <div class="col-sm-12 col-md-4 col-lg-3">
                <button [disabled]="servicioForm.invalid || cargando || !mascota_seleccionada || !buscarMascota || adelantoError" (click)="registrarServicio()" type="button" class="btn btn-primary  btn-icon-split">
                    <span class="text">Registrar&nbsp;&nbsp;&nbsp;&nbsp;<i class="fas fa-save"></i></span>
                </button>
            </div>
            <div class="col-sm-12 col-md-4 col-lg-3">
                <button type="button" (click)="closeModal();" class="btn btn-warning  btn-icon-split">
                    <span class="text">Volver&nbsp;&nbsp;&nbsp;&nbsp;<i class="fas fa-arrow-circle-left"></i></span>
                </button>
            </div>
            
        </div>
    </div>
</ng-template>


<ng-template #clienteModal>
    <div class="modal-header justify-content-center">
        <h4 class="modal-title " >Registrar cliente</h4>
    </div>
    <mat-progress-bar *ngIf="cargando && modalIn" mode="indeterminate" ></mat-progress-bar>
    <ngb-alert *ngIf="mostrar_alerta && modalIn" [type]="tipo_alerta" (closed)="mostrar_alerta = false" >{{mensaje_alerta}}</ngb-alert>
    <div class="modal-body">

        <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs">
            <li [ngbNavItem]="1">
                <a ngbNavLink>Natural</a>
                <ng-template ngbNavContent>
                    <form [formGroup]="clienteForm">
                        <div class="row color-row-table mt-4 mb-3">
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputNombreClienteNatural" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Nombre: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input formControlName="nombres" type="text" id="inputNombreClienteNatural" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="nombres.invalid && (nombres.dirty || nombres.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="nombres.errors.required">
                                        * El nombre del cliente es requerido.
                                    </div>
                                    <div *ngIf="nombres.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="nombres.errors.maxlength">
                                        * Se requieren máximo 100 caracteres.
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-6">
                                <label for="inputApellidosClienteNatural">Apellidos:</label>
                                <input formControlName="apellidos" type="text" id="inputApellidosClienteNatural" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="apellidos.invalid && (apellidos.dirty || apellidos.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="apellidos.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="apellidos.errors.maxlength">
                                        * Se requieren máximo 30 caracteres.
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row color-row-table mb-3">
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputCelularClienteNatural" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Celular:</label>
                                <input formControlName="celular" type="text" id="inputCelularClienteNatural" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="celular.invalid && (celular.dirty || celular.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="celular.errors.required">
                                        * El celular del cliente es requerido.
                                    </div>
                                    <div *ngIf="celular.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="celular.errors.minlength">
                                        * Se requieren mínimo 9 caracteres.
                                    </div>
                                    <div *ngIf="celular.errors.maxlength">
                                        * Se requieren máximo 9 caracteres.
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-6">
                                <label for="inputDNIClienteNatural" data-toggle="tooltip" data-placement="top" title="*Obligatorio">DNI: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input formControlName="dni" type="text" id="inputDNIClienteNatural" class="mt-lg-0 mt-md-4 border-left-primary font-tamanio form-control">
                                <div *ngIf="dni.invalid && (dni.dirty || dni.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="dni.errors.required">
                                        * El dni del cliente es requerido.
                                    </div>
                                    <div *ngIf="dni.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="dni.errors.minlength">
                                        * Se requieren mínimo 8 caracteres.
                                    </div>
                                    <div *ngIf="dni.errors.maxlength">
                                        * Se requieren máximo 8 caracteres.
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row color-row-table mb-3">
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputDireccionClienteNatural">Dirección:</label>
                                <input formControlName="direccion" type="text" id="inputDireccionClienteNatural" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="direccion.invalid && (direccion.dirty || direccion.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="direccion.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="direccion.errors.maxlength">
                                        * Se requieren maximo 100 caracteres.
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputDireccionClienteNatural">Email:</label>
                                <input formControlName="correo_" type="text" id="inputcorreo_ClienteNatural" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="correo_.invalid && (correo_.dirty || correo_.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="correo_.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="correo_.errors.maxlength">
                                        * Se requieren maximo 60 caracteres.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="row d-flex text-center justify-content-center">
                        <div class="my-2 col-sm-12 col-md-12 col-lg-3">
                            <button [disabled]="clienteForm.invalid || cargando" (click)="registrarClienteNatural()" class="btn btn-primary btn-icon-split">
                                <span class="text">Registrar&nbsp;<i class="fas fa-save"></i></span>
                            </button>
                        </div>
                        <div class="my-2 col-sm-12 col-md-12 col-lg-3">
                            <button (click)="closeModal()" class="btn btn-warning btn-icon-split">
                                <span class="text">Volver&nbsp;<i class="fas fa-arrow-circle-left"></i></span>
                            </button>
                        </div>
                    </div>
                </ng-template>
            </li>
            <li [ngbNavItem]="2">
                <a ngbNavLink>Jurídico</a>
                <ng-template ngbNavContent>
                    <form [formGroup]="clienteJuridicoForm">
                        <div class="row color-row-table mt-4 mb-3">
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputNombreClienteJuridico" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Nombre: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input formControlName="nombres_" type="text" id="inputNombreClienteJuridico" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="nombres_.invalid && (nombres_.dirty || nombres_.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="nombres_.errors.required">
                                        * El nombre es requerido.
                                    </div>
                                    <div *ngIf="nombres_.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="nombres_.errors.maxlength">
                                        * Se requieren máximo 100 caracteres.
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-6">
                                <label for="inputRazonSocialClienteJuridico" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Razón Social: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input formControlName="razon_social" type="text" id="inputRazonSocialClienteJuridico" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="razon_social.invalid && (razon_social.dirty || razon_social.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="razon_social.errors.required">
                                        * Los razón social del cliente es requerida.
                                    </div>
                                    <div *ngIf="razon_social.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="razon_social.errors.maxlength">
                                        * Se requieren máximo 100 caracteres.
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row color-row-table mb-3">
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputRUCClienteJuridico" data-toggle="tooltip" data-placement="top" title="*Obligatorio">RUC: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input formControlName="ruc" type="text" id="inputRUCClienteJuridico" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="ruc.invalid && (ruc.dirty || ruc.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="ruc.errors.required">
                                        * El ruc del cliente es requerido.
                                    </div>
                                    <div *ngIf="ruc.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="ruc.errors.minlength">
                                        * Se requieren mínimo 11 caracteres.
                                    </div>
                                    <div *ngIf="ruc.errors.maxlength">
                                        * Se requieren máximo 11 caracteres.
                                    </div>
                                </div>
                                
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-6">
                                <label for="inputTipoEmpresa" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Empresa: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <select  formControlName="tipo_empresa" id="inputTipoEmpresa" class="border-left-primary form-select">
                                    <option hidden value="" disabled>Escoge una opción</option>
                                    <option [value]="empresa.TIPO_EMPRESA_ID" *ngFor="let empresa of empresas">{{empresa.TIPO_EMPRESA_CLAVE}}</option>
                                </select>
                                <div *ngIf="tipo_empresa.invalid && (tipo_empresa.dirty || tipo_empresa.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="tipo_empresa.errors.required">
                                        * El tipo de empresa es requerido.
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row color-row-table justify-content-center mb-3">
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputDireccionClienteJuridico">Dirección:</label>
                                <input formControlName="direccion_" type="text" id="inputDireccionClienteJuridico" class="mt-lg-0 mt-md-4 border-left-primary font-tamanio form-control">
                                <div *ngIf="direccion_.invalid && (direccion_.dirty || direccion_.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="direccion_.errors.required">
                                        * La dirección del cliente es requerida.
                                    </div>
                                    <div *ngIf="direccion_.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="direccion_.errors.maxlength">
                                        * Se requieren maximo 100 caracteres.
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-6">
                                <label for="inputCelularClienteJuridico">Celular:</label>
                                <input formControlName="celular_" type="text" id="inputCelularClienteJuridico" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="celular_.invalid && (celular_.dirty || celular_.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="celular_.errors.required">
                                        * El celular_ del cliente es requerido.
                                    </div>
                                    <div *ngIf="celular_.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="celular_.errors.minlength">
                                        * Se requieren mínimo 9 caracteres.
                                    </div>
                                    <div *ngIf="celular_.errors.maxlength">
                                        * Se requieren máximo 9 caracteres.
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row color-row-table justify-content-center mb-3">
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputEmailClienteJuridico">Email:</label>
                                <input formControlName="correo" type="text" id="inputEmailClienteJuridico" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="correo.invalid && (correo.dirty || correo.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="correo.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="correo.errors.maxlength">
                                        * Se requieren maximo 60 caracteres.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="row d-flex text-center justify-content-center">
                        <div class="my-2 col-sm-12 col-md-12 col-lg-3">
                            <button [disabled]="clienteJuridicoForm.invalid || cargando" (click)="registrarClienteJuridico()" class="btn btn-primary btn-icon-split">
                                <span class="text">Registrar&nbsp;<i class="fas fa-save"></i></span>
                            </button>
                        </div>
                        <div class="my-2 col-sm-12 col-md-12 col-lg-3">
                            <button (click)="closeModal()" class="btn btn-warning btn-icon-split">
                                <span class="text">Volver&nbsp;<i class="fas fa-arrow-circle-left"></i></span>
                            </button>
                        </div>
                    </div>
                </ng-template>
            </li>
        </ul>
          
        <div [ngbNavOutlet]="nav" class="mt-2"></div>
    </div>
</ng-template>


<ng-template #crearMascotaModal>
    <div class="modal-header justify-content-center">
        <h4 class="modal-title " >Registrar Mascota</h4>
    </div>
    <mat-progress-bar *ngIf="cargando && modalIn" mode="indeterminate" ></mat-progress-bar>
    <ngb-alert *ngIf="mostrar_alerta && modalIn" [type]="tipo_alerta" (closed)="mostrar_alerta = false" >{{mensaje_alerta}}</ngb-alert>
    <div class="modal-body">
        <div class="row justify-content-center">
            <div class="card shadow mb-3 col-12 col-lg-8">
                <div class="card-body">
                    <form [formGroup]="mascotaForm">
                        <div class="row color-row-table mt-4 mb-3">
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputNombreMascota" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Nombre de la mascota: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input formControlName="nombre" type="text" id="inputNombreMascota" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="nombre.invalid && (nombre.dirty || nombre.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="nombre.errors.required">
                                        * El nombre de la mascota es requerido.
                                    </div>
                                    <div *ngIf="nombre.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="nombre.errors.minlength">
                                        * Se requieren máximo 3 caracteres.
                                    </div>
                                    <div *ngIf="nombre.errors.maxlength">
                                        * Se requieren máximo 45 caracteres.
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-6">
                                <label for="inputEspecieMascota" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Especie: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input formControlName="especie" type="text" id="inputEspecieMascota" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="especie.invalid && (especie.dirty || especie.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="especie.errors.required">
                                        * La especie de la mascota es requerida.
                                    </div>
                                    <div *ngIf="especie.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="especie.errors.minlength">
                                        * Se requieren mínimo 3 caracteres.
                                    </div>
                                    <div *ngIf="especie.errors.maxlength">
                                        * Se requieren máximo 20 caracteres.
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row color-row-table mb-3">
                            <div class="col-sm-12 col-md-6 col-lg-6 mb-3">
                                <label for="inputRazaMascota" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Raza: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input formControlName="raza" type="text" id="inputRazaMascota" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="raza.invalid && (raza.dirty || raza.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="raza.errors.required">
                                        * El raza de la mascota es requerida.
                                    </div>
                                    <div *ngIf="raza.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="raza.errors.minlength">
                                        * Se requieren mínimo 3 caracteres.
                                    </div>
                                    <div *ngIf="raza.errors.maxlength">
                                        * Se requieren máximo 20 caracteres.
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-12 col-md-6 col-lg-6">
                                <label for="inputColorMascota" data-toggle="tooltip" data-placement="top" title="*Obligatorio">Color: <small class="text-danger" data-toggle="tooltip" data-placement="top" title="*Obligatorio">(*)</small></label>
                                <input formControlName="color" type="text" id="inputColorMascota" class="border-left-primary font-tamanio form-control">
                                <div *ngIf="color.invalid && (color.dirty || color.touched)" class="my-1" style="color: rgb(197, 68, 68);">
                                    <div *ngIf="color.errors.required">
                                        * El color de la mascota es requerido.
                                    </div>
                                    <div *ngIf="color.errors.pattern">
                                        * El formato es inválido.
                                    </div>
                                    <div *ngIf="color.errors.minlength">
                                        * Se requieren mínimo 3 caracteres.
                                    </div>
                                    <div *ngIf="color.errors.maxlength">
                                        * Se requieren máximo 20 caracteres.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="row justify-content-center mt-4">
            <div class="card shadow mb-3 col-12 col-lg-11" >
                <div class="card-header py-3 row justify-content-between">
                    <div class="col-sm-12 col-md-12 col-lg-4 mb-4">
                        <label for="inputBuscarCategoria"><i class="fa fa-search"></i>&nbsp;&nbsp;&nbsp;&nbsp;Dueño:</label>
                        <div class="row ">
                            <div class="col-10">
                                <input id="inputBuscarCategoria" type="text" [(ngModel)]="busquedaCliente" class="border-left-primary font-tamanio form-control" name="busquedaCliente" placeholder="Ingrese Nombre..." >
                            </div>
                            <div class="col-1">
                                <button class="btn btn-success" (click)="filtrarCliente()"><i class="fa fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-12 col-md-12 col-lg-4">
                        <label for="inputBuscarCategoria"><i class="fa fa-user"></i>&nbsp;&nbsp;&nbsp;&nbsp;Nombre cliente:</label>
                        <input disabled type="text" value="{{nombreCliente}}" class="border-left-primary font-tamanio form-control" >
                    </div>
                </div>
                <div class="card-body text-gray-400 ">
                    <div  *ngIf="clientes.length<=0; else clienteModule">
                        <h3>No hay clientes registrados.</h3>
                    </div>
                    <!---------------PAGINACIÓN------------->
                    <div *ngIf="clientes?.length>0" class="row box-footer clearfix mt-3">     
                        <div class="col-xl-10 col-lg-9 col-md-7 col-sm-7 col-6">
                            <ngb-pagination *ngIf="clientes?.length>5" class="d-flex justify-content-start" size="sm" [maxSize]="5" [pageSize]="itemsPerPageModal"  [collectionSize]="clientes?.length" [(page)]="currentPageModal"></ngb-pagination>
                        </div>
                        <div class="col-xl-2 col-lg-3 col-md-5 col-sm-5 col-6">
                            <select class="pull-right" [(ngModel)]="itemsPerPageModal" class="form-control form-control-sm custom-select">
                                <option value="50">50 elementos</option>                    
                                <option value="100">100 elementos</option>                    
                                <option value="200">200 elementos</option>                    
                            </select>  
                        </div>    
                    </div>
                    <ng-template #clienteModule>
                        <div class="table-module">
                            <table class="table table-bordered text-gray-400" id="dataTable" cellspacing="1">
                                <thead>
                                    <tr>
                                        <th class="color-row-table puntero">Agregar</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="CLIENTE_ID" (sort)="onSorted($event)">Código</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="CLIENTE_NOMBRES" (sort)="onSorted($event)">Nombres</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="CLIENTE_TELEFONO" (sort)="onSorted($event)">Teléfono</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="CLIENTE_DNI" (sort)="onSorted($event)">DNI/RUC</th>
                                        <th class="color-row-table text-center puntero" scope="col" sortable="CLIENTE_DIRECCION" (sort)="onSorted($event)">Dirección</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let cliente of clientes| filterClienteByName:busquedaCliente |slice:(currentPageModal-1)*itemsPerPageModal:currentPageModal*itemsPerPageModal ; let i = index ">
                                        <td class="color-row-table text-center">
                                            <span (click)="agregarCliente(cliente)" class="btn btn-success btn-circle btn-sm" ngbTooltip="Agregar" >
                                                <i class="fa fa-check" aria-hidden="true"></i>
                                            </span>
                                        </td>
                                        <td [ngStyle]="{'background':cliente.CLIENTE_ID==clienteSeleccionado?'#0d6efd':'white','color':cliente.CLIENTE_ID==clienteSeleccionado?'white':'#6E707E'}" class="color-row-table">{{cliente.CLIENTE_ID}}</td>
                                        <td [ngStyle]="{'background':cliente.CLIENTE_ID==clienteSeleccionado?'#0d6efd':'white','color':cliente.CLIENTE_ID==clienteSeleccionado?'white':'#6E707E'}" class="color-row-table">{{cliente.CLIENTE_NOMBRES}}</td>
                                        <td [ngStyle]="{'background':cliente.CLIENTE_ID==clienteSeleccionado?'#0d6efd':'white','color':cliente.CLIENTE_ID==clienteSeleccionado?'white':'#6E707E'}" class="color-row-table">{{cliente.CLIENTE_TELEFONO}}</td>
                                        <td [ngStyle]="{'background':cliente.CLIENTE_ID==clienteSeleccionado?'#0d6efd':'white','color':cliente.CLIENTE_ID==clienteSeleccionado?'white':'#6E707E'}" class="color-row-table">{{cliente?.CLIENTE_DNI}}</td>
                                        <td [ngStyle]="{'background':cliente.CLIENTE_ID==clienteSeleccionado?'#0d6efd':'white','color':cliente.CLIENTE_ID==clienteSeleccionado?'white':'#6E707E'}" class="color-row-table">{{cliente.CLIENTE_DIRECCION}}</td>
                                        
                                    </tr>
                                </tbody>
                                
                            </table>
                            
                        </div>
                    </ng-template>
                </div>
            </div>
        </div>
        <div class="row d-flex text-center justify-content-center">
            <div class="my-2 col-sm-12 col-md-12 col-lg-3">
                <button [disabled]="mascotaForm.invalid || cargando" (click)="registrarMascota()" class="btn btn-primary btn-icon-split">
                    <span class="text">Registrar&nbsp;<i class="fas fa-save"></i></span>
                </button>
            </div>
            <div class="my-2 col-sm-12 col-md-12 col-lg-3">
                <button (click)="closeModal()" class="btn btn-warning btn-icon-split">
                    <span class="text">Volver&nbsp;<i class="fas fa-arrow-circle-left"></i></span>
                </button>
            </div>
        </div>
          
    </div>
</ng-template>